<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title># (Python) @Property까지 가는 길 | cjlee38</title><meta name=keywords content="null"><meta name=description content="Note 1. 개인적으로 공부해가며 작성한 글이기 때문에 틀린 내용이 있을 수 있습니다. 틀린 내용을 발견하시면 언제든 지적 부탁드립니다.
Note 2. 이해를 돕기 위해 일부 내용은 Java와 비교해가며 글을 작성했습니다.
 0. 들어가며 : 한동안 Java를 애용하다가, Python을 다뤄야 하는 일이 생겨서 다시 Python을 붙잡게 되었습니다. Java의 syntax에 대해서 어느정도 이해하고 있다고 자만하던 중이었기 때문에, Python을 사용하면서 &ldquo;왜 Python에는 Java의 이런 기능이 없지? 역시 Java가 짱이야&rdquo; 라는 생각도 하곤 했습니다."><meta name=author content="cjlee38"><link rel=canonical href=http://cjlee38.github.io/backup/language/python/2021-09-16-journey-to-property/><link crossorigin=anonymous href=/assets/css/stylesheet.min.48a18943c2fc15c38a372b8dde1f5e5dc0bc64fa6cb90f5a817d2f8c76b7f3ae.css integrity="sha256-SKGJQ8L8FcOKNyuN3h9eXcC8ZPpsuQ9agX0vjHa3864=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=http://cjlee38.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://cjlee38.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://cjlee38.github.io/favicon-32x32.png><link rel=apple-touch-icon href=http://cjlee38.github.io/apple-touch-icon.png><link rel=mask-icon href=http://cjlee38.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="# (Python) @Property까지 가는 길"><meta property="og:description" content="Note 1. 개인적으로 공부해가며 작성한 글이기 때문에 틀린 내용이 있을 수 있습니다. 틀린 내용을 발견하시면 언제든 지적 부탁드립니다.
Note 2. 이해를 돕기 위해 일부 내용은 Java와 비교해가며 글을 작성했습니다.
 0. 들어가며 : 한동안 Java를 애용하다가, Python을 다뤄야 하는 일이 생겨서 다시 Python을 붙잡게 되었습니다. Java의 syntax에 대해서 어느정도 이해하고 있다고 자만하던 중이었기 때문에, Python을 사용하면서 &ldquo;왜 Python에는 Java의 이런 기능이 없지? 역시 Java가 짱이야&rdquo; 라는 생각도 하곤 했습니다."><meta property="og:type" content="article"><meta property="og:url" content="http://cjlee38.github.io/backup/language/python/2021-09-16-journey-to-property/"><meta property="article:section" content="backup"><meta property="article:published_time" content="2021-09-16T22:05:00+00:00"><meta property="article:modified_time" content="2021-09-16T22:05:00+00:00"><meta property="og:site_name" content="cjlee38"><meta name=twitter:card content="summary"><meta name=twitter:title content="# (Python) @Property까지 가는 길"><meta name=twitter:description content="Note 1. 개인적으로 공부해가며 작성한 글이기 때문에 틀린 내용이 있을 수 있습니다. 틀린 내용을 발견하시면 언제든 지적 부탁드립니다.
Note 2. 이해를 돕기 위해 일부 내용은 Java와 비교해가며 글을 작성했습니다.
 0. 들어가며 : 한동안 Java를 애용하다가, Python을 다뤄야 하는 일이 생겨서 다시 Python을 붙잡게 되었습니다. Java의 syntax에 대해서 어느정도 이해하고 있다고 자만하던 중이었기 때문에, Python을 사용하면서 &ldquo;왜 Python에는 Java의 이런 기능이 없지? 역시 Java가 짱이야&rdquo; 라는 생각도 하곤 했습니다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Backups","item":"http://cjlee38.github.io/backup/"},{"@type":"ListItem","position":2,"name":"# (Python) @Property까지 가는 길","item":"http://cjlee38.github.io/backup/language/python/2021-09-16-journey-to-property/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"# (Python) @Property까지 가는 길","name":"# (Python) @Property까지 가는 길","description":"Note 1. 개인적으로 공부해가며 작성한 글이기 때문에 틀린 내용이 있을 수 있습니다. 틀린 내용을 발견하시면 언제든 지적 부탁드립니다.\nNote 2. 이해를 돕기 위해 일부 내용은 Java와 비교해가며 글을 작성했습니다.\n 0. 들어가며 : 한동안 Java를 애용하다가, Python을 다뤄야 하는 일이 생겨서 다시 Python을 붙잡게 되었습니다. Java의 syntax에 대해서 어느정도 이해하고 있다고 자만하던 중이었기 때문에, Python을 사용하면서 \u0026ldquo;왜 Python에는 Java의 이런 기능이 없지? 역시 Java가 짱이야\u0026rdquo; 라는 생각도 하곤 했습니다.","keywords":["null"],"articleBody":" Note 1. 개인적으로 공부해가며 작성한 글이기 때문에 틀린 내용이 있을 수 있습니다. 틀린 내용을 발견하시면 언제든 지적 부탁드립니다.\nNote 2. 이해를 돕기 위해 일부 내용은 Java와 비교해가며 글을 작성했습니다.\n 0. 들어가며 : 한동안 Java를 애용하다가, Python을 다뤄야 하는 일이 생겨서 다시 Python을 붙잡게 되었습니다. Java의 syntax에 대해서 어느정도 이해하고 있다고 자만하던 중이었기 때문에, Python을 사용하면서 “왜 Python에는 Java의 이런 기능이 없지? 역시 Java가 짱이야” 라는 생각도 하곤 했습니다.\n그런데 python의 getter와 setter에 대해서 알아보던 중, @property 라는 녀석을 이해해보려고 자료를 찾다 보니, Python의 진면목 일부를 엿볼 수 있는 기회가 되었습니다.\npython의 아주 기본적인 문법만 알고 있던 사람들에게 본 글이 시야를 넓히는데 도움이 되길 바라면서, 시작하겠습니다.\n1. 그래서 @Property 가 뭔가요 ? 흔히 “객체지향” 에서는, 객체가 갖고 있는 Field 를 적절하게 외부로 노출시키거나 숨기기 위해, getter/setter를 사용합니다.\nJava에서는 private 이라는 키워드로 갖고 있는 멤버변수들을 모두 숨기고, 보여줄 내용은 getter 메소드를, 외부에 의해 변경되어도 되는 변수는 setter 메소드를 활용해 데이터를 관리하죠.\n따라서 직접적으로 변수에 접근하는 것은 원천적으로 금지되어 있고, 메소드 호출을 통해서만 데이터를 조작할 수 있습니다.\nclass Person {   private String name;  private int age;   public Person(String name, int age) {  this.name = name;  this.age = age;  }   public String getName() {  return this.name;  }   public int getAge() {  return this.age;  }   public void setAge(int age) {  if (age  0)  throw new IllegalArgumentException(\"나이는 0 이하가 될 수 없습니다.\");  this.age = age;  } }  public class Main {  public static void main(String[] args) {  Person person = new Person(\"Mr.Kim\", 26);  System.out.println(person.getName()); // \"Mr.Kim\";  person.setAge(-62); // IllegalArgumentException(\"나이는 0 이하가 될 수 없습니다.\")  } } 그러나 python 에서는 programming language 수준에서 접근 권한을 제어할 수 없습니다. 따라서 _(언더스코어) 를 활용하는 방법을 제공하지만, 결국 _{클래스명}__{변수명} 으로 접근이 가능합니다.(이후 뒤에서 설명할 property도 결국 직접 접근하는 방법은 있습니다.)\n따라서 python 에서는 기본적으로 모두 public 이라고 생각하면 됩니다. 하지만 그렇다고 해서 getter/setter를 쓸 필요가 없다는 것은 아닙니다. 당장 위와 같은 예시만 보더라도, setAge() 메소드를 호출할 때, 나이가 음수인지 아닌지 검증하는 로직이 필요하기 때문입니다. 위 코드를 python 으로는 다음과 같이 쓸 수 있습니다.\nclass Person :  def __init__(self, name, age) :  self._name = name  self._age = age   # 다른 메소드는 편의상 생략합니다.   def set_age(self, new_age) :  if new_age  0 :  raise Exception(\"나이는 0 이하가 될 수 없습니다.\")  self._age = new_age  if __name__ == '__main__' :  person = Person(\"Mr.Kim\", 26)  person.set_age(-62) # Exception('나이는 0 이하가 될 수 없습니다.') 여기까지는 Java와 똑같습니다. 하지만, 이런 식의 코드 사용은 explicit 하지 못하다는 단점이 있습니다. 만약 기존 나이에서 1살을 더해줘야 한다면, 다음과 같이 작성해야 합니다.\nperson.set_age(person.get_age() + 1) 뿐만 아니라, person._age = -62 와 같은 코드는 방어할 수가 없어진다는 문제도 여전히 남아있죠. 그러나 @property 를 활용하면 다음과 같은 코드가 가능합니다.\nperson.age += 1 person.age = -62 # Exception('나이는 0 이하가 될 수 없습니다.') ??? 어떻게 된 일일까요?\n변수에 값을 직접 대입하는 것 같은데, 로직에 따른 Exception을 던지고 있습니다. 어떻게 이것이 가능한지는 차차 알아보기로 하고, 일단 생김새부터 살펴봅시다. 위 Person 클래스에 @Property를 적용하면 다음과 같이 작성할 수 있습니다.\nclass Person :  def __init__(self, name, age) :  self._name = name  self._age = age   @property  def age(self) :  return self._age   @age.setter  def age(self, new_age) :  if new_age  0 :  raise Exception(\"나이는 0 이하가 될 수 없습니다.\")  self._age = new_age 대충 살펴 봤을때, 눈에 띄는 차이점은 다음과 같습니다.\n 함수의 이름이 get_age 혹은 set_age 가 아니라, 그냥 age 자체로 바뀌었습니다. 계속 언급했던 @property 가 age 메소드 위에 붙었습니다. 또한, @age.setter 라는 녀석도 두 번째 age 메소드 위에 붙었습니다.  이러한 변화가 어떻게 앞서 언급했던 동작에 영향을 미쳤는지 하나씩 알아가봅시다.\n@property를 이해하기 위한 배경지식들은 다음과 같습니다.\n Everything is Object Decorator Descriptor Object  1. Everything is Object Python에서 다루는 모든 값은 객체입니다. Java에서는 일반적으로 값을 Primitive Type, Reference Type 으로 구분하죠. 반면 Python에서는 int, bool과 같은 값들도 모두 객체로 다뤄집니다.\na = 1 print(id(a)) # 4341049696 id 함수는 Built-in 함수로, 객체가 가지고 있는 주소값을 나타냅니다. 따라서 id(a)라는 코드는 1 이라는 값이 할당된 메모리 주소를 반환합니다. Java에서는 Integer 와 비슷하다고 생각하시면 될 것 같습니다.\n이에 더해, Python 에서는 함수마저도 객체입니다.\ndef my_func() :  return \"hello world\"  print(my_func.__str__()) # '' 위 예시에서 보시다시피, my_func 이라는 이름의 함수를 만든 뒤, 해당 함수가 갖고 있는 __str__ 이라는 메소드를 호출할 수 있습니다. 즉, my_func 자체는 Function 이라는 클래스를 상속하는 클래스입니다.\n간단하게 생각하면, def my_func() 라는 키워드는 my_func = {함수 바디} 와 같이 변수로 정의되는 것을 상상해볼 수 있겠습니다.\n Note. 함수가 객체라는 이야기를 할 때, 1급 시민 이라는 키워드가 자주 등장합니다. 1급 시민이란, 변수에 할당할 수 있어야 하고, argument로 전달될 수 있으며, return 으로 반환될 수 있는 값들을 말합니다. Java에서 메소드는 일급 객체가 아니지만, 인터페이스를 활용해 1급 시민의 흉내를 낼 수 있게 되었습니다.\n 2. Decorator 데코레이터를 이야기하려면 Python 함수가 갖는 또 다른 특징을 알아야 합니다.\n1) 함수는 중첩이 가능하다. python은 다음과 같이 함수를 중첩해서 정의할 수 있습니다.\ndef outer() :  def inner() :  print('inner called')  print('outer called')  inner()  return inner  var = outer() # outer called \\n inner called (1) var() # inner called (2) outer 함수 안에 inner 함수를 정의한 뒤, inner 함수를 호출했습니다. 따라서 var = outer() 를 통해 outer함수를 호출할 때, 내부에 있는 inner 함수 (1)도 실행됩니다.\n다음으로 return inner를 통해 inner 함수 그 자체를 돌려주고, 해당 함수 객체는 var 라는 변수에 저장됩니다. 따라서 var() 를 통해 함수를 실행하는 것은 결국 inner 함수를 실행하는 것과 같습니다.\n2) Enclosed Function Locals python의 함수가 갖는 두 번째 특징은, 이러한 중첩 함수로 인해 조금 특별한 변수 scope가 생긴다는 것입니다.\nC를 처음 배웠을 무렵, 지역변수 전역변수와 같은 개념에 대해서 배우고, “내가 허용된 범위의 바깥 변수는 알 수 없다”, “가까운 scope부터 찾아 나간다” 정도의 개념으로 정리하고 넘어갔었습니다.\npython에서는 후자, 즉 “가까운 scope부터 찾아 나간다\"는 맞는 말이지만, 전자인 “내가 허용된 범위 바깥 변수는 알 수 없다” 는 조금 다릅니다. 요약하자면, “내가 허용된 범위 바깥 변수에 접근할 수는 있지만, 수정할 수는 없다.” 정도가 될 것 같습니다.\nx = 1 def outer() :  y = 2  def inner() :  z = 3  print(z, y, x)  inner()  return inner  a = outer() # 3 2 1 a() # 3 2 1 아까 예시를 들었던 outer/inner 함수를 약간 변형해보았습니다. outer 함수가 실행되던 와중에 inner가 호출되든, 함수 객체를 return 받은 a가 호출되든 상관없이, 모두 3 2 1을 출력합니다.\n Note. python에서는 가까운 곳부터 찾아나가는 접근법을 LEGB 규칙 이라고 명명했습니다. 순서대로 Local, Enclosed function locals, Global, Built-in 의 약자이며, z, y, x 변수가 이에 해당합니다. 마지막 Built-in 변수는 __name__과 같이 “내가 정의하지도 않았는데 기존에 정의되어 있던 값들\"을 말합니다.\n 하지만 다음의 예시는 쓰기에 대해서는 조금 다른 결과임을 보여줍니다.\nx = 1 def outer() :  y = 2  def inner() :  z = 3  y += 1 # UnboundLocalError: local variable 'y' referenced before assignment  x += 1 # UnboundLocalError: local variable 'x' referenced before assignment   print(z, y, x)  inner()  return inner  a = outer() a() inner 내부에서 y와 x에 대해서 값을 1씩 더하려고 하자 할당되기 전에 참조되었다는 에러를 발생시킵니다. 즉, 자기 자신의 scope 바깥에 있는 변수에 대해서는 “쓰기” 연산에 대해, 즉 “변경\"에 대해 제한되어 있습니다.\n Note. 만약 해당 값을 수정하고 싶다면 nonlocal 혹은 global 키워드를 통해 “내가 외부의 값을 수정하고자 한다” 라는 의도를 드러내야 합니다.\n 3) Closure Closure는 위키피디아에서 다음과 같이 설명하고 있습니다.\n컴퓨터 언어에서 클로저(Closure)는 일급 객체 함수(first-class functions)의 개념을 이용하여 스코프(scope)에 묶인 변수를 바인딩 하기 위한 일종의 기술이다. 이러한 설명은 처음 Closure를 접한 사람들에게 전혀 도움이 되지 않습니다. 심지어 Closure라는 네이밍 그 자체에서도 어떠한 힌트를 얻기는 어렵습니다. 예시를 살펴보면서 이해해보겠습니다.\ndef outer(val) :  def inner() :  print('inner called')  print(val)  print('outer called')  return inner  a = outer(10) # ??? a() # ??? 첫 번째로 실행한 a = outer(10), 두 번째로 실행한 a() 코드가 각각 어떻게 돌아갈지 한번 상상해볼까요?\na = outer(10)에 의해 outer 함수를 호출했고, argument로 10을 넘겨주고, 이를 val 이라는 이름으로 받아냅니다. 그 내부에서 inner 함수를 정의했고, outer called 를 출력한 뒤, inner 함수 객체를 돌려줍니다.\n두 번째로 a() 를 통해, a 변수가 갖고 있는 inner 함수 객체를 호출합니다. inner called를 출력한 뒤, val을 출력하려고 하는데, 여기서 의문점이 하나 생깁니다. 해당 함수는 자신 바깥에 있는, 즉 val 변수를 참조하고 있습니다. 앞서 이야기한 LEGB 규칙에 따르면, L 에서 E를 참조하는 셈이죠.\n여기서 val은 살아 있을까요? 바꿔말하면, val 변수를 참조해서 아까 넣어준 10 이라는 값을 얻어낼 수 있을까요? 정답은 “YES” 입니다.\n이렇게 보니 마치 outer 라는 클래스가 val 이라는 멤버변수를 가지고 있는 것처럼 느껴집니다. 여기까지 읽고 나서, 다시 위키피디아의 정의를 살펴보겠습니다.\n컴퓨터 언어에서 클로저(Closure)는 일급 객체 함수(first-class functions)의 개념을 이용하여 스코프(scope)에 묶인 변수를 바인딩 하기 위한 일종의 기술이다. 이렇게 보니 100% 이해하지는 못하더라도, 어떤 느낌으로 설명하고 있는지는 알 것 같습니다. Closure라는 이름 또한 직역 시 “폐쇄” 라는 뜻을 갖고 있는데, 조금 과장해서 “폐쇄망” … “인트라넷” … “나만의 구역” .. 과 같은 연결고리로 생각이 들기도 합니다.\n Note. 어떠한 함수 A 가 Closure이기 위해서는 다음의 세 가지 조건이 만족되어야 합니다.\n A 함수는 다른 함수 B 안에 정의된 함수, 즉 중첩된 함수여야 한다. 자신을 둘러싼 함수 B scope 의 값을 참조해야 한다. B 함수는 A 함수를 반환해야 한다.   여기서 한 단계 더 나아가보겠습니다.\ndef outer(func) :  def inner() :  print('inner called')  func()  print('outer called')  return inner  def my_func() :  print('my_func called')  a = outer(my_func) # outer called a() # inner called \\n my_func called 앞서는 val 이라는 숫자 값을 넣어줬지만, 이번에는 my_func 이라는 함수를 넣어주고 있습니다. 거듭 반복해서 보여드리고 있듯이, 함수 또한 객체이기 떄문에(a.k.a 1급 시민) 다른 함수의 argument로 전달될 수 있습니다.\n여기서는 outer 라는 함수의 argument로 my_func을 전달하고 있고, 좀 전과 마찬가지로 my_func는 outer 함수의 호출이 끝나더라도 inner에 의해 참조되고 있습니다.\n4) 드디어.. Decorator를 알기 위한 사전 지식은 준비되었으니, 이제 본격적으로 알아보겠습니다.\n바로 위의 예시에서는 a = outer(my_func) 라는 함수를 통해 closure를 만들고, a() 를 통해 inner 함수, 즉 closure 를 호출했습니다. Decorator를 활용하면 이를 보다 손쉽게 정의할 수 있습니다.\n즉, 다음의 두 코드는 같습니다.\n기존\ndef outer(func) :  ...  def my_func() :  ...  a = outer(my_func) # outer called a() # inner called \\n my_func called 데코레이터\ndef outer(func) :  ...  @outer # outer called def my_func() :  ...  a = my_func() # inner called \\n my_func called  여기서 한 가지 주의할 점은, 데코레이터 버전에서 outer called 는 @outer를 붙여서 my_func를 정의하는 시점에 호출된다는 점입니다.\n이렇게 보니 Decorator 라는 이름이 왜 Decorator 인지 알 것 같습니다. 또한, Spring의 AOP는 Python에서는 Decorator를 활용해 간단히 구현할 수 있겠다는 생각도 듭니다.\n3. Descriptor Object Descriptor 는 객체 A가 갖고있는 속성인 객체 B를 다룰 때 조회, 저장 및 삭제를 사용자 정의할 수 있는 객체 B를 디스크립터라고 이야기합니다.\n이 Descriptor라는 녀석은 객체 A의 클래스 변수로서 정의되어야 합니다. (the descriptor must be in either the owner’s class dictionary or in the class dictionary for one of its parents)\n역시, 예시를 보면서 진행하겠습니다.\nclass Age :  def __init__(self, age) :  self._age = age   def __get__(self, obj, objtype) :  print(\"__get__ method called\")  return self._age   def __set__(self, obj, val) :  print(\"__set__ method called\")  self._age = val   def __delete__(self, obj) :  print(\"__delete__ method called\")  self._age = -1  class Person :  age = Age(26)  p = Person() print(p.age) # __get__ method called \\n 26 p.age = 20 # __set__ method called del p.age # __delete__ method called print(p.age) # __get__method called \\n -1 Age 라는 클래스를 만들고, __get__, __set__, __delete__ 메소드를 정의했습니다. 이 세개의 메소드는 스페셜 메소드 라고 불리우며, 객체가 갖는 특성을 지정할 수 있습니다. 가장 대표적으로 __init__ 메소드는 인스턴스 생성시에 동작하는 행위에 대해서 정의할 수 있습니다.\n어떠한 객체에 위에서 언급한 세 개의 __get__, __set__, __delete__ 메소드가 정의되었을 경우, 해당 객체를 “디스크립터” 라고 부르게 됩니다.\n Note. __get__ 메소드만 정의된 경우에는 Non-data Descriptor, __set__ 메소드 혹은 __delete__ 메소드가 정의된 경우에는 Data Descriptor 라고 부르게 됩니다. 이 둘의 차이는 우선순위에 있습니다만, 여기서는 다룰 내용이 아닌지라 스킵하겠습니다.\n 이렇게 Descriptor를 정의할 경우, 해당 객체로 접근할 때 우리가 생각했던 것처럼 값에 직접 접근하는 것이 아니라, 메소드 호출을 통해 접근하게 됩니다. 그림으로 보면 다음과 같이 상상해 볼 수 있겠습니다.\nDescriptor 라는 특별한 개념이 없다면, 코드 상으로는 객체가 위 그림과 비슷한 형태로 구성될 것이라고 예측할 수 있습니다. Person 안에 Age 객체가, 그리고 Age 객체 안에 _age 라는 멤버변수, __getter__, __setter__ 라는 메소드를 가질 뿐이죠. 따라서 p.age 로 접근하게 되면 Age() 객체로 접근할 것처럼 보입니다. 하지만 실질적으로는 다음 그림과 같습니다.\np.age를 호출하게 되는 순간, Person 객체 내에 있는 Age() 객체를 가져오려 하는데, __get__ 메소드가 오버라이드 되어 실질적으로는 Age() 객체가 아닌 그 내부의 self._age를 돌려주게 됩니다.\n이러한 동작 방식을 보고나면, 왜 Data Descriptor 라는 이름을 갖게 되었는지 이해되기 시작합니다. Data Descriptor로 정의된 객체는, 일반적으로 생각하는 것처럼 값을 갖고 메소드라는 행위를 갖지 않고, 대신 내가 원하는 Data(여기서는 _age라는 int 변수겠죠)에 대한 톨게이트와 같은 역할을 하게 됩니다.\n4. Property 장황한 이야기를 끝내고, 드디어 Property에 대한 이야기를 해보겠습니다. 앞서 보여드렸던 Property 사용 예시는 다음과 같습니다.\nclass Person :  def __init__(self, name, age) :  self._name = name  self._age = age   @property  def age(self) :  return self._age   @age.setter  def age(self, new_age) :  if new_age  0 :  raise Exception(\"나이는 0 이하가 될 수 없습니다.\")  self._age = new_age Decorator에 대해서 이해하고 왔으니, @property 라는 코드를 통해, property 라는 함수(함수는 다시 객체이니 정확히는 property라는 객체겠죠)로 age 라는 메소드를 전달한다는 사실을 알 수 있습니다.\n따라서, 아래와 같은 코드는\n@property def age( ... ) :  ... 실질적으로는 다음과 같다고 볼 수 있겠죠.\nage = property(age) 아까전에 def my_func() 라는 코드는 my_func = {함수바디}와 같이 변수로 정의되는 것을 상상해볼 수 있다고 말씀드렸었는데요. 같은 맥락임을 확인할 수 있습니다. 왜냐하면, @property 데코레이터를 사용해 age = property(age)로, 즉 클래스 변수로 만들었기 때문입니다. (Descriptor는 반드시 클래스 변수에 있어야 한다는 사실을 떠올려보세요.)\n파이썬 공식 문서에 있는 property의 생김새는 다음과 같습니다.\nclass Property:  \"Emulate PyProperty_Type() in Objects/descrobject.c\"   def __init__(self, fget=None, fset=None, fdel=None, doc=None):  self.fget = fget  self.fset = fset  self.fdel = fdel  if doc is None and fget is not None:  doc = fget.__doc__  self.__doc__ = doc   def __get__(self, obj, objtype=None):  if obj is None:  return self  if self.fget is None:  raise AttributeError(\"unreadable attribute\")  return self.fget(obj)   def __set__(self, obj, value):  if self.fset is None:  raise AttributeError(\"can't set attribute\")  self.fset(obj, value)   def __delete__(self, obj):  if self.fdel is None:  raise AttributeError(\"can't delete attribute\")  self.fdel(obj)   def getter(self, fget):  return type(self)(fget, self.fset, self.fdel, self.__doc__)   def setter(self, fset):  return type(self)(self.fget, fset, self.fdel, self.__doc__)   def deleter(self, fdel):  return type(self)(self.fget, self.fset, fdel, self.__doc__) 자, 이제 어떻게 코드가 동작하는지에 대해서 이해할 준비가 되었으니, 한 줄씩 따라가보며 총 정리해보겠습니다.\n@property def age( ... ) :  ... 위 코드를 통해 age = property(age) 가 실행된다고 말씀드렸었죠. property의 생성자 인자로 age라는 메소드를 넘겨줬으니, 이 age는 __init__ 메소드 내부에서 fget 이라는 변수에 할당됨을 확인할 수 있습니다. 그리고 @property를 적용한 Person 클래스의 현재 생김새는 다음과 같습니다.\nclass Person :  def __init__(self, name, age) :  self._name = name  self._age = age   def age(self) :  return self._age   age = property(age)   @age.setter  def age(self, new_age) :  if new_age  0 :  raise Exception(\"나이는 0 이하가 될 수 없습니다.\")  self._age = new_age 다음으로 @age.setter 부분을 살펴봅니다. 현재 age는 property 객체인 상태입니다. 그러면 @age.setter는 다음과 같이 해석됩니다. age가 계속 나와 헷갈리니 주석을 참고하세요.\nage = property(age) # age(1번) = property(age(2번)) # age 라는 이름의 변수(1번)에 'age 메소드'(2번)를 인자로 넘긴 property 객체를 저장합니다. age = age.setter(age) # age(3) = age(1).setter(age(4)) # age라는 이름의 변수(3번)에, property 객체를 갖고 있는 age 변수(1번)의 setter 메소드에 새로운 age 메소드(4)를 넘겨줍니다. 그리고 setter 메소드를 살펴볼까요?\ndef setter(self, fset):  return type(self)(self.fget, fset, self.fdel, self.__doc__) type(self) 부분은 자기 자신에 대한 type을 구하고 있습니다. self는 property 이니 다음과 같이 해석됩니다.\ndef setter(self, fset):  return property(self.fget, fset, self.fdel, self.__doc__) 자기 자신에 대해서 생성자를 호출하고 있네요. 꼭 마치 자바에서 생성자에 this()와 비슷해 보입니다. 또한, 나머지는 self 키워드를 붙여서 자기 자신이 갖고 있던 녀석들을 넘겨주고, fset 위치에만 age(self, new_age) 라는 메소드를 넘겨주고 있습니다.\n이제 Person 객체에서 age를 접근할 때 무슨일이 일어날까요? p.age 로 꺼낸 age는 property 객체라는 사실은 이 쯤 되면 잘 아실거라 생각합니다. property 객체는 연이어 __get__ 메소드를 호출하겠죠.\ndef __get__(self, obj, objtype=None):  if obj is None:  return self  if self.fget is None:  raise AttributeError(\"unreadable attribute\")  return self.fget(obj) __get__ 메소드의 인자 obj는 자기 자신을 실행한 인스턴스, objtype은 해당 클래스를 의미합니다. p.age로 인스턴스를 통해 실행했으니 obj는 p일 것이고, objtype 은 Person 이네요.\nobj가 None이 아니고, fget 또한 아까 할당되었으니, return self.fget(obj)가 실행됩니다.\n즉, fget(obj) 의 fget은 앞서 정의한 def age(self) 이니, 아까 내가 정의한 getter 메소드, 즉 다음 메소드가 실행됩니다.\ndef age(self) :  return self._age 다음으로 __set__ 메소드를 살펴볼까요? p.age = -10 이라고 작성했다면, 역시 p.age 변수가 갖고 있는 객체는 property 객체이고, 해당 객체의 __set__ 메소드가 호출됩니다.\ndef __set__(self, obj, value):  if self.fset is None:  raise AttributeError(\"can't set attribute\")  self.fset(obj, value) 마찬가지로 obj는 자기 자신을 실행한 인스턴스, 즉 p 이고, value는 -10 입니다. fset 변수는 앞서 할당한 def age(self, new_age) 함수 객체이고, None이 아니니 self.fset(obj, value)를 실행합니다. 즉, 다음 메소드가 실행됩니다.\ndef age(self, new_age) :  if new_age  0 :  raise Exception(\"나이는 0 이하가 될 수 없습니다.\")  self._age = new_age 마지막으로 __delete__ 는 __setter__와 같으니 추가적으로 다루지는 않겠습니다.\n5. 마무리 여러 개념을 융합해서 새로운 개념을 이해하는 것은 언제나 어려운 일이기 때문에 꽤 구구절절 설명하는 경향도 없잖아 있었습니다. 그러다보니 약 600줄에 가까운 글이 되었습니다.\n그렇기에 한줄한줄 곱씹어가며 글을 읽으셨다면 크게 어렵지 않으셨을 것이라 생각합니다. 그 동안 프로퍼티를 사용만 하고 그 동작 원리에 대해 잘 모르셨던 분들에게 좋은 설명이 되었기를, 그리고 기존 프로그래밍의 사고를 확장시킬 수 있는 계기가 되었기를 바랍니다.\n감사합니다.\n Reference  Python의 Closure에 대해 알아보자 Wikidocs 레벨업 파이썬 - 클로저 Python 공식문서 - Descriptor Hardcore in Programming - Descriptor [Python 지식]- Descriptor 우선순위  ","wordCount":"2751","inLanguage":"en","datePublished":"2021-09-16T22:05:00Z","dateModified":"2021-09-16T22:05:00Z","author":{"@type":"Person","name":"cjlee38"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://cjlee38.github.io/backup/language/python/2021-09-16-journey-to-property/"},"publisher":{"@type":"Organization","name":"cjlee38","logo":{"@type":"ImageObject","url":"http://cjlee38.github.io/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://cjlee38.github.io/ accesskey=h title="Home (Alt + H)"><img src=http://cjlee38.github.io/assets/icon.jpeg alt=logo aria-label=logo height=35>Home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=http://cjlee38.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=http://cjlee38.github.io/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://cjlee38.github.io/>Home</a>&nbsp;»&nbsp;<a href=http://cjlee38.github.io/backup/>Backups</a></div><h1 class=post-title># (Python) @Property까지 가는 길</h1><div class=post-meta><span title="2021-09-16 22:05:00 +0000 UTC">September 16, 2021</span>&nbsp;·&nbsp;13 min&nbsp;·&nbsp;cjlee38&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/backup/Language/Python/2021-09-16-journey-to-property.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#0-%eb%93%a4%ec%96%b4%ea%b0%80%eb%a9%b0 aria-label="0. 들어가며">0. 들어가며</a></li><li><a href=#1-%ea%b7%b8%eb%9e%98%ec%84%9c-property-%ea%b0%80-%eb%ad%94%ea%b0%80%ec%9a%94- aria-label="1. 그래서 @Property 가 뭔가요 ?">1. 그래서 @Property 가 뭔가요 ?</a></li><li><a href=#1-everything-is-object aria-label="1. Everything is Object">1. Everything is Object</a></li><li><a href=#2-decorator aria-label="2. Decorator">2. Decorator</a><ul><li><a href=#1-%ed%95%a8%ec%88%98%eb%8a%94-%ec%a4%91%ec%b2%a9%ec%9d%b4-%ea%b0%80%eb%8a%a5%ed%95%98%eb%8b%a4 aria-label="1) 함수는 중첩이 가능하다.">1) 함수는 중첩이 가능하다.</a></li><li><a href=#2-enclosed-function-locals aria-label="2) Enclosed Function Locals">2) Enclosed Function Locals</a></li><li><a href=#3-closure aria-label="3) Closure">3) Closure</a></li><li><a href=#4-%eb%93%9c%eb%94%94%ec%96%b4 aria-label="4) 드디어..">4) 드디어..</a></li></ul></li><li><a href=#3-descriptor-object aria-label="3. Descriptor Object">3. Descriptor Object</a></li><li><a href=#4-property aria-label="4. Property">4. Property</a></li><li><a href=#5-%eb%a7%88%eb%ac%b4%eb%a6%ac aria-label="5. 마무리">5. 마무리</a><ul><li><a href=#reference aria-label=Reference>Reference</a></li></ul></li></ul></div></details></div><div class=post-content><blockquote><p>Note 1. 개인적으로 공부해가며 작성한 글이기 때문에 틀린 내용이 있을 수 있습니다. 틀린 내용을 발견하시면 언제든 지적 부탁드립니다.<br>Note 2. 이해를 돕기 위해 일부 내용은 Java와 비교해가며 글을 작성했습니다.</p></blockquote><h1 id=0-들어가며>0. 들어가며<a hidden class=anchor aria-hidden=true href=#0-들어가며>#</a></h1><p>: 한동안 Java를 애용하다가, Python을 다뤄야 하는 일이 생겨서 다시 Python을 붙잡게 되었습니다. Java의 syntax에 대해서 어느정도 이해하고 있다고 자만하던 중이었기 때문에, Python을 사용하면서 &ldquo;왜 Python에는 Java의 이런 기능이 없지? 역시 Java가 짱이야&rdquo; 라는 생각도 하곤 했습니다.</p><p>그런데 python의 getter와 setter에 대해서 알아보던 중, <code>@property</code> 라는 녀석을 이해해보려고 자료를 찾다 보니, Python의 진면목 일부를 엿볼 수 있는 기회가 되었습니다.</p><p>python의 아주 기본적인 문법만 알고 있던 사람들에게 본 글이 시야를 넓히는데 도움이 되길 바라면서, 시작하겠습니다.</p><h1 id=1-그래서-property-가-뭔가요->1. 그래서 @Property 가 뭔가요 ?<a hidden class=anchor aria-hidden=true href=#1-그래서-property-가-뭔가요->#</a></h1><p>흔히 &ldquo;객체지향&rdquo; 에서는, 객체가 갖고 있는 <code>Field</code> 를 적절하게 외부로 노출시키거나 숨기기 위해, <code>getter/setter</code>를 사용합니다.</p><p>Java에서는 <code>private</code> 이라는 키워드로 갖고 있는 멤버변수들을 모두 숨기고, 보여줄 내용은 <code>getter</code> 메소드를, 외부에 의해 변경되어도 되는 변수는 <code>setter</code> 메소드를 활용해 데이터를 관리하죠.</p><p>따라서 직접적으로 변수에 접근하는 것은 원천적으로 금지되어 있고, 메소드 호출을 통해서만 데이터를 조작할 수 있습니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String name<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> age<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Person</span><span style=color:#f92672>(</span>String name<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> age<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>name</span> <span style=color:#f92672>=</span> name<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>age</span> <span style=color:#f92672>=</span> age<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>getName</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>name</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>getAge</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>age</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setAge</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> age<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>age <span style=color:#f92672>&lt;=</span> 0<span style=color:#f92672>)</span> 
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> IllegalArgumentException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;나이는 0 이하가 될 수 없습니다.&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>age</span> <span style=color:#f92672>=</span> age<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Main</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Person person <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Person<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Mr.Kim&#34;</span><span style=color:#f92672>,</span> 26<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>person<span style=color:#f92672>.</span><span style=color:#a6e22e>getName</span><span style=color:#f92672>());</span> <span style=color:#75715e>// &#34;Mr.Kim&#34;;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        person<span style=color:#f92672>.</span><span style=color:#a6e22e>setAge</span><span style=color:#f92672>(-</span>62<span style=color:#f92672>);</span> <span style=color:#75715e>// IllegalArgumentException(&#34;나이는 0 이하가 될 수 없습니다.&#34;)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>그러나 python 에서는 programming language 수준에서 접근 권한을 제어할 수 없습니다. 따라서 _(언더스코어) 를 활용하는 방법을 제공하지만, 결국 <code>_{클래스명}__{변수명}</code> 으로 접근이 가능합니다.(이후 뒤에서 설명할 property도 결국 직접 접근하는 방법은 있습니다.)</p><p>따라서 python 에서는 기본적으로 모두 <code>public</code> 이라고 생각하면 됩니다. 하지만 그렇다고 해서 <code>getter/setter</code>를 쓸 필요가 없다는 것은 아닙니다. 당장 위와 같은 예시만 보더라도, <code>setAge()</code> 메소드를 호출할 때, 나이가 음수인지 아닌지 검증하는 로직이 필요하기 때문입니다. 위 코드를 python 으로는 다음과 같이 쓸 수 있습니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span> :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, name, age) :
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_name <span style=color:#f92672>=</span> name
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> age
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 다른 메소드는 편의상 생략합니다.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>set_age</span>(self, new_age) :
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> new_age <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span> :
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>Exception</span>(<span style=color:#e6db74>&#34;나이는 0 이하가 될 수 없습니다.&#34;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> new_age
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span> :
</span></span><span style=display:flex><span>    person <span style=color:#f92672>=</span> Person(<span style=color:#e6db74>&#34;Mr.Kim&#34;</span>, <span style=color:#ae81ff>26</span>)
</span></span><span style=display:flex><span>    person<span style=color:#f92672>.</span>set_age(<span style=color:#f92672>-</span><span style=color:#ae81ff>62</span>) <span style=color:#75715e># Exception(&#39;나이는 0 이하가 될 수 없습니다.&#39;)</span>
</span></span></code></pre></div><p>여기까지는 Java와 똑같습니다. 하지만, 이런 식의 코드 사용은 <code>explicit</code> 하지 못하다는 단점이 있습니다. 만약 기존 나이에서 1살을 더해줘야 한다면, 다음과 같이 작성해야 합니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>person<span style=color:#f92672>.</span>set_age(person<span style=color:#f92672>.</span>get_age() <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)
</span></span></code></pre></div><p>뿐만 아니라, <code>person._age = -62</code> 와 같은 코드는 방어할 수가 없어진다는 문제도 여전히 남아있죠. 그러나 <code>@property</code> 를 활용하면 다음과 같은 코드가 가능합니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>person<span style=color:#f92672>.</span>age <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>person<span style=color:#f92672>.</span>age <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>62</span> <span style=color:#75715e># Exception(&#39;나이는 0 이하가 될 수 없습니다.&#39;)</span>
</span></span></code></pre></div><p>??? 어떻게 된 일일까요?<br>변수에 값을 직접 대입하는 것 같은데, 로직에 따른 Exception을 던지고 있습니다. 어떻게 이것이 가능한지는 차차 알아보기로 하고, 일단 생김새부터 살펴봅시다. 위 <code>Person</code> 클래스에 <code>@Property</code>를 적용하면 다음과 같이 작성할 수 있습니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span> :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, name, age) :
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_name <span style=color:#f92672>=</span> name
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> age
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@property</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>(self) :
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>_age
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@age</span><span style=color:#f92672>.</span>setter
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>(self, new_age) :
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> new_age <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span> :
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>Exception</span>(<span style=color:#e6db74>&#34;나이는 0 이하가 될 수 없습니다.&#34;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> new_age
</span></span></code></pre></div><p>대충 살펴 봤을때, 눈에 띄는 차이점은 다음과 같습니다.</p><ol><li>함수의 이름이 <code>get_age</code> 혹은 <code>set_age</code> 가 아니라, 그냥 <code>age</code> 자체로 바뀌었습니다.</li><li>계속 언급했던 <code>@property</code> 가 <code>age</code> 메소드 위에 붙었습니다. 또한, <code>@age.setter</code> 라는 녀석도 두 번째 <code>age</code> 메소드 위에 붙었습니다.</li></ol><p>이러한 변화가 어떻게 앞서 언급했던 동작에 영향을 미쳤는지 하나씩 알아가봅시다.</p><p><code>@property</code>를 이해하기 위한 배경지식들은 다음과 같습니다.</p><ol><li>Everything is Object</li><li>Decorator</li><li>Descriptor Object</li></ol><h1 id=1-everything-is-object>1. Everything is Object<a hidden class=anchor aria-hidden=true href=#1-everything-is-object>#</a></h1><p>Python에서 다루는 모든 값은 객체입니다. Java에서는 일반적으로 값을 <code>Primitive Type</code>, <code>Reference Type</code> 으로 구분하죠. 반면 Python에서는 <code>int</code>, <code>bool</code>과 같은 값들도 모두 객체로 다뤄집니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>a <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>print(id(a)) <span style=color:#75715e># 4341049696</span>
</span></span></code></pre></div><p><code>id</code> 함수는 Built-in 함수로, 객체가 가지고 있는 주소값을 나타냅니다. 따라서 <code>id(a)</code>라는 코드는 1 이라는 값이 할당된 메모리 주소를 반환합니다. Java에서는 <code>Integer</code> 와 비슷하다고 생각하시면 될 것 같습니다.</p><p>이에 더해, Python 에서는 <strong>함수마저도</strong> 객체입니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>my_func</span>() :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;hello world&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(my_func<span style=color:#f92672>.</span>__str__()) <span style=color:#75715e># &#39;&lt;function my_func at 0x7ffd70cf1f70&gt;&#39;</span>
</span></span></code></pre></div><p>위 예시에서 보시다시피, <code>my_func</code> 이라는 이름의 함수를 만든 뒤, 해당 함수가 갖고 있는 <code>__str__</code> 이라는 메소드를 호출할 수 있습니다. 즉, <code>my_func</code> 자체는 <code>Function</code> 이라는 클래스를 상속하는 클래스입니다.</p><p>간단하게 생각하면, <code>def my_func()</code> 라는 키워드는 <code>my_func = {함수 바디}</code> 와 같이 변수로 정의되는 것을 상상해볼 수 있겠습니다.</p><blockquote><p>Note. 함수가 객체라는 이야기를 할 때, <code>1급 시민</code> 이라는 키워드가 자주 등장합니다. 1급 시민이란, 변수에 할당할 수 있어야 하고, argument로 전달될 수 있으며, return 으로 반환될 수 있는 값들을 말합니다. Java에서 메소드는 일급 객체가 아니지만, 인터페이스를 활용해 1급 시민의 흉내를 낼 수 있게 되었습니다.</p></blockquote><h1 id=2-decorator>2. Decorator<a hidden class=anchor aria-hidden=true href=#2-decorator>#</a></h1><p>데코레이터를 이야기하려면 Python 함수가 갖는 또 다른 특징을 알아야 합니다.</p><h2 id=1-함수는-중첩이-가능하다>1) 함수는 중첩이 가능하다.<a hidden class=anchor aria-hidden=true href=#1-함수는-중첩이-가능하다>#</a></h2><p>python은 다음과 같이 함수를 중첩해서 정의할 수 있습니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>outer</span>() :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>inner</span>() :
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;inner called&#39;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;outer called&#39;</span>)
</span></span><span style=display:flex><span>    inner()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> inner
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>var <span style=color:#f92672>=</span> outer() <span style=color:#75715e># outer called \n inner called (1)</span>
</span></span><span style=display:flex><span>var() <span style=color:#75715e># inner called (2)</span>
</span></span></code></pre></div><p><code>outer</code> 함수 안에 <code>inner</code> 함수를 정의한 뒤, <code>inner</code> 함수를 호출했습니다. 따라서 <code>var = outer()</code> 를 통해 <code>outer</code>함수를 호출할 때, 내부에 있는 <code>inner</code> 함수 (1)도 실행됩니다.</p><p>다음으로 <code>return inner</code>를 통해 <code>inner</code> 함수 그 자체를 돌려주고, 해당 <code>함수 객체</code>는 <code>var</code> 라는 변수에 저장됩니다. 따라서 <code>var()</code> 를 통해 함수를 실행하는 것은 결국 <code>inner</code> 함수를 실행하는 것과 같습니다.</p><h2 id=2-enclosed-function-locals>2) Enclosed Function Locals<a hidden class=anchor aria-hidden=true href=#2-enclosed-function-locals>#</a></h2><p>python의 함수가 갖는 두 번째 특징은, 이러한 중첩 함수로 인해 조금 특별한 변수 scope가 생긴다는 것입니다.</p><p>C를 처음 배웠을 무렵, 지역변수 전역변수와 같은 개념에 대해서 배우고, &ldquo;내가 허용된 범위의 바깥 변수는 알 수 없다&rdquo;, &ldquo;가까운 scope부터 찾아 나간다&rdquo; 정도의 개념으로 정리하고 넘어갔었습니다.</p><p>python에서는 후자, 즉 &ldquo;가까운 scope부터 찾아 나간다"는 맞는 말이지만, 전자인 &ldquo;내가 허용된 범위 바깥 변수는 알 수 없다&rdquo; 는 조금 다릅니다. 요약하자면, &ldquo;내가 허용된 범위 바깥 변수에 접근할 수는 있지만, 수정할 수는 없다.&rdquo; 정도가 될 것 같습니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>x <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>outer</span>() :
</span></span><span style=display:flex><span>    y <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>inner</span>() :
</span></span><span style=display:flex><span>        z <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>        print(z, y, x)
</span></span><span style=display:flex><span>    inner()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> inner
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> outer() <span style=color:#75715e># 3 2 1</span>
</span></span><span style=display:flex><span>a() <span style=color:#75715e># 3 2 1</span>
</span></span></code></pre></div><p>아까 예시를 들었던 <code>outer/inner</code> 함수를 약간 변형해보았습니다. <code>outer</code> 함수가 실행되던 와중에 <code>inner</code>가 호출되든, 함수 객체를 return 받은 <code>a</code>가 호출되든 상관없이, 모두 3 2 1을 출력합니다.</p><blockquote><p>Note. python에서는 가까운 곳부터 찾아나가는 접근법을 <strong>LEGB 규칙</strong> 이라고 명명했습니다. 순서대로 Local, Enclosed function locals, Global, Built-in 의 약자이며, <code>z</code>, <code>y</code>, <code>x</code> 변수가 이에 해당합니다. 마지막 Built-in 변수는 __name__과 같이 &ldquo;내가 정의하지도 않았는데 기존에 정의되어 있던 값들"을 말합니다.</p></blockquote><p>하지만 다음의 예시는 쓰기에 대해서는 조금 다른 결과임을 보여줍니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>x <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>outer</span>() :
</span></span><span style=display:flex><span>    y <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>inner</span>() :
</span></span><span style=display:flex><span>        z <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>        y <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span> <span style=color:#75715e># UnboundLocalError: local variable &#39;y&#39; referenced before assignment</span>
</span></span><span style=display:flex><span>        x <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span> <span style=color:#75715e># UnboundLocalError: local variable &#39;x&#39; referenced before assignment</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        print(z, y, x)
</span></span><span style=display:flex><span>    inner()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> inner
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> outer()
</span></span><span style=display:flex><span>a()
</span></span></code></pre></div><p><code>inner</code> 내부에서 <code>y</code>와 <code>x</code>에 대해서 값을 1씩 더하려고 하자 할당되기 전에 참조되었다는 에러를 발생시킵니다. 즉, 자기 자신의 scope 바깥에 있는 변수에 대해서는 &ldquo;쓰기&rdquo; 연산에 대해, 즉 &ldquo;변경"에 대해 제한되어 있습니다.</p><blockquote><p>Note. 만약 해당 값을 수정하고 싶다면 <code>nonlocal</code> 혹은 <code>global</code> 키워드를 통해 &ldquo;내가 외부의 값을 수정하고자 한다&rdquo; 라는 의도를 드러내야 합니다.</p></blockquote><h2 id=3-closure>3) Closure<a hidden class=anchor aria-hidden=true href=#3-closure>#</a></h2><p>Closure는 위키피디아에서 다음과 같이 설명하고 있습니다.</p><pre tabindex=0><code>컴퓨터 언어에서 클로저(Closure)는 일급 객체 함수(first-class functions)의 개념을 이용하여 스코프(scope)에 묶인 변수를 바인딩 하기 위한 일종의 기술이다.
</code></pre><p>이러한 설명은 처음 Closure를 접한 사람들에게 전혀 도움이 되지 않습니다. 심지어 <code>Closure</code>라는 네이밍 그 자체에서도 어떠한 힌트를 얻기는 어렵습니다. 예시를 살펴보면서 이해해보겠습니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>outer</span>(val) :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>inner</span>() :
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;inner called&#39;</span>)
</span></span><span style=display:flex><span>        print(val)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;outer called&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> inner
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> outer(<span style=color:#ae81ff>10</span>) <span style=color:#75715e># ???</span>
</span></span><span style=display:flex><span>a() <span style=color:#75715e># ???</span>
</span></span></code></pre></div><p>첫 번째로 실행한 <code>a = outer(10)</code>, 두 번째로 실행한 <code>a()</code> 코드가 각각 어떻게 돌아갈지 한번 상상해볼까요?</p><p><code>a = outer(10)</code>에 의해 <code>outer</code> 함수를 호출했고, argument로 <code>10</code>을 넘겨주고, 이를 val 이라는 이름으로 받아냅니다. 그 내부에서 <code>inner</code> 함수를 정의했고, <code>outer called</code> 를 출력한 뒤, <code>inner</code> 함수 객체를 돌려줍니다.</p><p>두 번째로 <code>a()</code> 를 통해, <code>a</code> 변수가 갖고 있는 <code>inner</code> 함수 객체를 호출합니다. <code>inner called</code>를 출력한 뒤, <code>val</code>을 출력하려고 하는데, <strong>여기서 의문점이 하나 생깁니다.</strong> 해당 함수는 자신 바깥에 있는, 즉 <code>val</code> 변수를 참조하고 있습니다. 앞서 이야기한 <code>LEGB 규칙</code>에 따르면, <code>L</code> 에서 <code>E</code>를 참조하는 셈이죠.</p><p>여기서 <code>val</code>은 살아 있을까요? 바꿔말하면, <code>val</code> 변수를 참조해서 아까 넣어준 <code>10</code> 이라는 값을 얻어낼 수 있을까요? 정답은 <strong>&ldquo;YES&rdquo;</strong> 입니다.</p><p>이렇게 보니 마치 <code>outer</code> 라는 클래스가 <code>val</code> 이라는 멤버변수를 가지고 있는 것처럼 느껴집니다. 여기까지 읽고 나서, 다시 위키피디아의 정의를 살펴보겠습니다.</p><pre tabindex=0><code>컴퓨터 언어에서 클로저(Closure)는 일급 객체 함수(first-class functions)의 개념을 이용하여 스코프(scope)에 묶인 변수를 바인딩 하기 위한 일종의 기술이다.
</code></pre><p>이렇게 보니 100% 이해하지는 못하더라도, 어떤 느낌으로 설명하고 있는지는 알 것 같습니다. <code>Closure</code>라는 이름 또한 직역 시 &ldquo;폐쇄&rdquo; 라는 뜻을 갖고 있는데, 조금 과장해서 &ldquo;폐쇄망&rdquo; &mldr; &ldquo;인트라넷&rdquo; &mldr; &ldquo;나만의 구역&rdquo; .. 과 같은 연결고리로 생각이 들기도 합니다.</p><blockquote><p>Note. 어떠한 함수 A 가 Closure이기 위해서는 다음의 세 가지 조건이 만족되어야 합니다.</p><ol><li>A 함수는 다른 함수 B 안에 정의된 함수, 즉 중첩된 함수여야 한다.</li><li>자신을 둘러싼 함수 B scope 의 값을 참조해야 한다.</li><li>B 함수는 A 함수를 반환해야 한다.</li></ol></blockquote><p>여기서 한 단계 더 나아가보겠습니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>outer</span>(func) :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>inner</span>() :
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;inner called&#39;</span>)
</span></span><span style=display:flex><span>        func()
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;outer called&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> inner
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>my_func</span>() :
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;my_func called&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> outer(my_func) <span style=color:#75715e># outer called</span>
</span></span><span style=display:flex><span>a() <span style=color:#75715e># inner called \n my_func called</span>
</span></span></code></pre></div><p>앞서는 <code>val</code> 이라는 숫자 값을 넣어줬지만, 이번에는 <code>my_func</code> 이라는 함수를 넣어주고 있습니다. 거듭 반복해서 보여드리고 있듯이, 함수 또한 객체이기 떄문에(a.k.a 1급 시민) 다른 함수의 argument로 전달될 수 있습니다.</p><p>여기서는 <code>outer</code> 라는 함수의 argument로 <code>my_func</code>을 전달하고 있고, 좀 전과 마찬가지로 <code>my_func</code>는 <code>outer</code> 함수의 호출이 끝나더라도 <code>inner</code>에 의해 참조되고 있습니다.</p><h2 id=4-드디어>4) 드디어..<a hidden class=anchor aria-hidden=true href=#4-드디어>#</a></h2><p><code>Decorator</code>를 알기 위한 사전 지식은 준비되었으니, 이제 본격적으로 알아보겠습니다.</p><p>바로 위의 예시에서는 <code>a = outer(my_func)</code> 라는 함수를 통해 closure를 만들고, <code>a()</code> 를 통해 <code>inner</code> 함수, 즉 closure 를 호출했습니다. Decorator를 활용하면 이를 보다 손쉽게 정의할 수 있습니다.</p><p>즉, 다음의 두 코드는 같습니다.</p><p>기존</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>outer</span>(func) :
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>my_func</span>() :
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> outer(my_func) <span style=color:#75715e># outer called</span>
</span></span><span style=display:flex><span>a() <span style=color:#75715e># inner called \n my_func called</span>
</span></span></code></pre></div><p>데코레이터</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>outer</span>(func) :
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@outer</span>  <span style=color:#75715e># outer called</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>my_func</span>() :
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> my_func() <span style=color:#75715e># inner called \n my_func called </span>
</span></span></code></pre></div><p>여기서 한 가지 주의할 점은, 데코레이터 버전에서 <code>outer called</code> 는 <code>@outer</code>를 붙여서 <code>my_func</code>를 정의하는 시점에 호출된다는 점입니다.</p><p>이렇게 보니 <code>Decorator</code> 라는 이름이 왜 <code>Decorator</code> 인지 알 것 같습니다. 또한, Spring의 AOP는 Python에서는 Decorator를 활용해 간단히 구현할 수 있겠다는 생각도 듭니다.</p><h1 id=3-descriptor-object>3. Descriptor Object<a hidden class=anchor aria-hidden=true href=#3-descriptor-object>#</a></h1><p>Descriptor 는 객체 A가 갖고있는 속성인 객체 B를 다룰 때 조회, 저장 및 삭제를 사용자 정의할 수 있는 객체 B를 디스크립터라고 이야기합니다.</p><p>이 Descriptor라는 녀석은 객체 A의 클래스 변수로서 정의되어야 합니다. (the descriptor must be in either the owner’s class dictionary or in the class dictionary for one of its parents)</p><p>역시, 예시를 보면서 진행하겠습니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Age</span> :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, age) :
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> age
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __get__(self, obj, objtype) :
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;__get__ method called&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>_age
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __set__(self, obj, val) :
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;__set__ method called&#34;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> val
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __delete__(self, obj) :
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;__delete__ method called&#34;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span> :
</span></span><span style=display:flex><span>    age <span style=color:#f92672>=</span> Age(<span style=color:#ae81ff>26</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p <span style=color:#f92672>=</span> Person()
</span></span><span style=display:flex><span>print(p<span style=color:#f92672>.</span>age) <span style=color:#75715e># __get__ method called \n 26</span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>age <span style=color:#f92672>=</span> <span style=color:#ae81ff>20</span> <span style=color:#75715e># __set__ method called</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>del</span> p<span style=color:#f92672>.</span>age <span style=color:#75715e># __delete__ method called</span>
</span></span><span style=display:flex><span>print(p<span style=color:#f92672>.</span>age) <span style=color:#75715e># __get__method called \n -1</span>
</span></span></code></pre></div><p>Age 라는 클래스를 만들고, <code>__get__</code>, <code>__set__</code>, <code>__delete__</code> 메소드를 정의했습니다. 이 세개의 메소드는 <strong>스페셜 메소드</strong> 라고 불리우며, 객체가 갖는 특성을 지정할 수 있습니다. 가장 대표적으로 <code>__init__</code> 메소드는 인스턴스 생성시에 동작하는 행위에 대해서 정의할 수 있습니다.</p><p>어떠한 객체에 위에서 언급한 세 개의 <code>__get__</code>, <code>__set__</code>, <code>__delete__</code> 메소드가 정의되었을 경우, 해당 객체를 &ldquo;디스크립터&rdquo; 라고 부르게 됩니다.</p><blockquote><p>Note. <code>__get__</code> 메소드만 정의된 경우에는 <code>Non-data Descriptor</code>, <code>__set__</code> 메소드 혹은 <code>__delete__</code> 메소드가 정의된 경우에는 <code>Data Descriptor</code> 라고 부르게 됩니다. 이 둘의 차이는 우선순위에 있습니다만, 여기서는 다룰 내용이 아닌지라 스킵하겠습니다.</p></blockquote><p>이렇게 Descriptor를 정의할 경우, 해당 객체로 접근할 때 우리가 생각했던 것처럼 값에 직접 접근하는 것이 아니라, 메소드 호출을 통해 접근하게 됩니다. 그림으로 보면 다음과 같이 상상해 볼 수 있겠습니다.</p><p><img loading=lazy src=../../../assets/images/2021-09-18-15-52-24.png alt></p><p>Descriptor 라는 특별한 개념이 없다면, 코드 상으로는 객체가 위 그림과 비슷한 형태로 구성될 것이라고 예측할 수 있습니다. <code>Person</code> 안에 <code>Age</code> 객체가, 그리고 <code>Age</code> 객체 안에 <code>_age</code> 라는 멤버변수, <code>__getter__</code>, <code>__setter__</code> 라는 메소드를 가질 뿐이죠. 따라서 <code>p.age</code> 로 접근하게 되면 <code>Age()</code> 객체로 접근할 것처럼 보입니다. 하지만 실질적으로는 다음 그림과 같습니다.</p><p><img loading=lazy src=../../../assets/images/2021-09-18-15-56-29.png alt></p><p><code>p.age</code>를 호출하게 되는 순간, <code>Person</code> 객체 내에 있는 <code>Age()</code> 객체를 가져오려 하는데, <code>__get__</code> 메소드가 오버라이드 되어 실질적으로는 <code>Age()</code> 객체가 아닌 그 내부의 <code>self._age</code>를 돌려주게 됩니다.</p><p>이러한 동작 방식을 보고나면, 왜 <code>Data Descriptor</code> 라는 이름을 갖게 되었는지 이해되기 시작합니다. <code>Data Descriptor</code>로 정의된 객체는, 일반적으로 생각하는 것처럼 값을 갖고 메소드라는 행위를 갖지 않고, 대신 내가 원하는 <code>Data</code>(여기서는 _age라는 int 변수겠죠)에 대한 톨게이트와 같은 역할을 하게 됩니다.</p><h1 id=4-property>4. Property<a hidden class=anchor aria-hidden=true href=#4-property>#</a></h1><p>장황한 이야기를 끝내고, 드디어 Property에 대한 이야기를 해보겠습니다. 앞서 보여드렸던 Property 사용 예시는 다음과 같습니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span> :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, name, age) :
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_name <span style=color:#f92672>=</span> name
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> age
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@property</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>(self) :
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>_age
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@age</span><span style=color:#f92672>.</span>setter
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>(self, new_age) :
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> new_age <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span> :
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>Exception</span>(<span style=color:#e6db74>&#34;나이는 0 이하가 될 수 없습니다.&#34;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> new_age
</span></span></code></pre></div><p>Decorator에 대해서 이해하고 왔으니, <code>@property</code> 라는 코드를 통해, <code>property</code> 라는 함수(함수는 다시 객체이니 정확히는 <code>property</code>라는 객체겠죠)로 <code>age</code> 라는 메소드를 전달한다는 사실을 알 수 있습니다.</p><p>따라서, 아래와 같은 코드는</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#a6e22e>@property</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>( <span style=color:#f92672>...</span> ) :
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span></code></pre></div><p>실질적으로는 다음과 같다고 볼 수 있겠죠.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>age <span style=color:#f92672>=</span> property(age)
</span></span></code></pre></div><p>아까전에 <code>def my_func()</code> 라는 코드는 <code>my_func = {함수바디}</code>와 같이 변수로 정의되는 것을 상상해볼 수 있다고 말씀드렸었는데요. 같은 맥락임을 확인할 수 있습니다. 왜냐하면, <code>@property</code> 데코레이터를 사용해 <code>age = property(age)</code>로, 즉 클래스 변수로 만들었기 때문입니다. (Descriptor는 반드시 클래스 변수에 있어야 한다는 사실을 떠올려보세요.)</p><p><a href=https://docs.python.org/3/howto/descriptor.html>파이썬 공식 문서</a>에 있는 <code>property</code>의 생김새는 다음과 같습니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Property</span>:
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Emulate PyProperty_Type() in Objects/descrobject.c&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, fget<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>, fset<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>, fdel<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>, doc<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>fget <span style=color:#f92672>=</span> fget
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>fset <span style=color:#f92672>=</span> fset
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>fdel <span style=color:#f92672>=</span> fdel
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> doc <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span> <span style=color:#f92672>and</span> fget <span style=color:#f92672>is</span> <span style=color:#f92672>not</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            doc <span style=color:#f92672>=</span> fget<span style=color:#f92672>.</span>__doc__
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>__doc__ <span style=color:#f92672>=</span> doc
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __get__(self, obj, objtype<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> obj <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> self
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>fget <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>AttributeError</span>(<span style=color:#e6db74>&#34;unreadable attribute&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>fget(obj)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __set__(self, obj, value):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>fset <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>AttributeError</span>(<span style=color:#e6db74>&#34;can&#39;t set attribute&#34;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>fset(obj, value)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __delete__(self, obj):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>fdel <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>AttributeError</span>(<span style=color:#e6db74>&#34;can&#39;t delete attribute&#34;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>fdel(obj)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>getter</span>(self, fget):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> type(self)(fget, self<span style=color:#f92672>.</span>fset, self<span style=color:#f92672>.</span>fdel, self<span style=color:#f92672>.</span>__doc__)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>setter</span>(self, fset):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> type(self)(self<span style=color:#f92672>.</span>fget, fset, self<span style=color:#f92672>.</span>fdel, self<span style=color:#f92672>.</span>__doc__)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>deleter</span>(self, fdel):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> type(self)(self<span style=color:#f92672>.</span>fget, self<span style=color:#f92672>.</span>fset, fdel, self<span style=color:#f92672>.</span>__doc__)
</span></span></code></pre></div><p>자, 이제 어떻게 코드가 동작하는지에 대해서 이해할 준비가 되었으니, 한 줄씩 따라가보며 총 정리해보겠습니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#a6e22e>@property</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>( <span style=color:#f92672>...</span> ) :
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span></code></pre></div><p>위 코드를 통해 <code>age = property(age)</code> 가 실행된다고 말씀드렸었죠. <code>property</code>의 생성자 인자로 <code>age</code>라는 메소드를 넘겨줬으니, 이 age는 <code>__init__</code> 메소드 내부에서 <code>fget</code> 이라는 변수에 할당됨을 확인할 수 있습니다. 그리고 <code>@property</code>를 적용한 <code>Person</code> 클래스의 현재 생김새는 다음과 같습니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span> :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, name, age) :
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_name <span style=color:#f92672>=</span> name
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> age
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>(self) :
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>_age
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    age <span style=color:#f92672>=</span> property(age)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@age</span><span style=color:#f92672>.</span>setter
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>(self, new_age) :
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> new_age <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span> :
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>Exception</span>(<span style=color:#e6db74>&#34;나이는 0 이하가 될 수 없습니다.&#34;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> new_age
</span></span></code></pre></div><p>다음으로 <code>@age.setter</code> 부분을 살펴봅니다. 현재 <code>age</code>는 <code>property</code> 객체인 상태입니다. 그러면 <code>@age.setter</code>는 다음과 같이 해석됩니다. age가 계속 나와 헷갈리니 주석을 참고하세요.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>age <span style=color:#f92672>=</span> property(age)
</span></span><span style=display:flex><span><span style=color:#75715e># age(1번) = property(age(2번))</span>
</span></span><span style=display:flex><span><span style=color:#75715e># age 라는 이름의 변수(1번)에 &#39;age 메소드&#39;(2번)를 인자로 넘긴 property 객체를 저장합니다.</span>
</span></span><span style=display:flex><span>age <span style=color:#f92672>=</span> age<span style=color:#f92672>.</span>setter(age) 
</span></span><span style=display:flex><span><span style=color:#75715e># age(3) = age(1).setter(age(4))</span>
</span></span><span style=display:flex><span><span style=color:#75715e># age라는 이름의 변수(3번)에, property 객체를 갖고 있는 age 변수(1번)의 setter 메소드에 새로운 age 메소드(4)를 넘겨줍니다.</span>
</span></span></code></pre></div><p>그리고 <code>setter</code> 메소드를 살펴볼까요?</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>setter</span>(self, fset):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> type(self)(self<span style=color:#f92672>.</span>fget, fset, self<span style=color:#f92672>.</span>fdel, self<span style=color:#f92672>.</span>__doc__)
</span></span></code></pre></div><p><code>type(self)</code> 부분은 자기 자신에 대한 <code>type</code>을 구하고 있습니다. <code>self</code>는 <code>property</code> 이니 다음과 같이 해석됩니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>setter</span>(self, fset):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> property(self<span style=color:#f92672>.</span>fget, fset, self<span style=color:#f92672>.</span>fdel, self<span style=color:#f92672>.</span>__doc__)
</span></span></code></pre></div><p>자기 자신에 대해서 생성자를 호출하고 있네요. 꼭 마치 자바에서 생성자에 <code>this()</code>와 비슷해 보입니다. 또한, 나머지는 <code>self</code> 키워드를 붙여서 자기 자신이 갖고 있던 녀석들을 넘겨주고, <code>fset</code> 위치에만 <code>age(self, new_age)</code> 라는 메소드를 넘겨주고 있습니다.</p><p>이제 <code>Person</code> 객체에서 <code>age</code>를 접근할 때 무슨일이 일어날까요? <code>p.age</code> 로 꺼낸 <code>age</code>는 <code>property</code> 객체라는 사실은 이 쯤 되면 잘 아실거라 생각합니다. <code>property</code> 객체는 연이어 <code>__get__</code> 메소드를 호출하겠죠.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> __get__(self, obj, objtype<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> obj <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>fget <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>AttributeError</span>(<span style=color:#e6db74>&#34;unreadable attribute&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>fget(obj)
</span></span></code></pre></div><p><code>__get__</code> 메소드의 인자 <code>obj</code>는 자기 자신을 실행한 인스턴스, <code>objtype</code>은 해당 클래스를 의미합니다. <code>p.age</code>로 인스턴스를 통해 실행했으니 <code>obj</code>는 p일 것이고, <code>objtype</code> 은 <code>Person</code> 이네요.<br><code>obj</code>가 <code>None</code>이 아니고, <code>fget</code> 또한 아까 할당되었으니, <code>return self.fget(obj)</code>가 실행됩니다.</p><p>즉, <code>fget(obj)</code> 의 fget은 앞서 정의한 <code>def age(self)</code> 이니, 아까 내가 정의한 <code>getter</code> 메소드, 즉 다음 메소드가 실행됩니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>(self) :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>_age
</span></span></code></pre></div><p>다음으로 <code>__set__</code> 메소드를 살펴볼까요? <code>p.age = -10</code> 이라고 작성했다면, 역시 <code>p.age</code> 변수가 갖고 있는 객체는 <code>property</code> 객체이고, 해당 객체의 <code>__set__</code> 메소드가 호출됩니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> __set__(self, obj, value):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>fset <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>AttributeError</span>(<span style=color:#e6db74>&#34;can&#39;t set attribute&#34;</span>)
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>fset(obj, value)
</span></span></code></pre></div><p>마찬가지로 obj는 자기 자신을 실행한 인스턴스, 즉 <code>p</code> 이고, <code>value</code>는 <code>-10</code> 입니다. <code>fset</code> 변수는 앞서 할당한 <code>def age(self, new_age)</code> 함수 객체이고, None이 아니니 <code>self.fset(obj, value)</code>를 실행합니다. 즉, 다음 메소드가 실행됩니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>(self, new_age) :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> new_age <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span> :
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>Exception</span>(<span style=color:#e6db74>&#34;나이는 0 이하가 될 수 없습니다.&#34;</span>)
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> new_age
</span></span></code></pre></div><p>마지막으로 <code>__delete__</code> 는 <code>__setter__</code>와 같으니 추가적으로 다루지는 않겠습니다.</p><h1 id=5-마무리>5. 마무리<a hidden class=anchor aria-hidden=true href=#5-마무리>#</a></h1><p>여러 개념을 융합해서 새로운 개념을 이해하는 것은 언제나 어려운 일이기 때문에 꽤 구구절절 설명하는 경향도 없잖아 있었습니다. 그러다보니 약 600줄에 가까운 글이 되었습니다.</p><p>그렇기에 한줄한줄 곱씹어가며 글을 읽으셨다면 크게 어렵지 않으셨을 것이라 생각합니다. 그 동안 프로퍼티를 사용만 하고 그 동작 원리에 대해 잘 모르셨던 분들에게 좋은 설명이 되었기를, 그리고 기존 프로그래밍의 사고를 확장시킬 수 있는 계기가 되었기를 바랍니다.</p><p>감사합니다.</p><hr><h2 id=reference>Reference<a hidden class=anchor aria-hidden=true href=#reference>#</a></h2><ul><li><a href=https://shoark7.github.io/programming/python/closure-in-python>Python의 Closure에 대해 알아보자</a></li><li><a href=https://wikidocs.net/81226>Wikidocs 레벨업 파이썬 - 클로저</a></li><li><a href=https://docs.python.org/3/howto/descriptor.html>Python 공식문서 - Descriptor</a></li><li><a href=https://kukuta.tistory.com/339>Hardcore in Programming - Descriptor</a></li><li><a href=https://m.blog.naver.com/r00tdr4g0n/222056023801>[Python 지식]- Descriptor 우선순위</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=http://cjlee38.github.io/tags/null/>null</a></li></ul><nav class=paginav><a class=prev href=http://cjlee38.github.io/backup/diary/2021-10-22-oop_truth_and_misunderstanding/><span class=title>« Prev Page</span><br><span># 객체지향의 사실과 오해를 읽고, 짧은 감상문</span></a>
<a class=next href=http://cjlee38.github.io/backup/language/java/2021-08-29-java-generics-2/><span class=title>Next Page »</span><br><span># 제네릭 톺아보기 2</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share # (Python) @Property까지 가는 길 on twitter" href="https://twitter.com/intent/tweet/?text=%23%20%28Python%29%20%40Property%ea%b9%8c%ec%a7%80%20%ea%b0%80%eb%8a%94%20%ea%b8%b8&url=http%3a%2f%2fcjlee38.github.io%2fbackup%2flanguage%2fpython%2f2021-09-16-journey-to-property%2f&hashtags=null"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share # (Python) @Property까지 가는 길 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fcjlee38.github.io%2fbackup%2flanguage%2fpython%2f2021-09-16-journey-to-property%2f&title=%23%20%28Python%29%20%40Property%ea%b9%8c%ec%a7%80%20%ea%b0%80%eb%8a%94%20%ea%b8%b8&summary=%23%20%28Python%29%20%40Property%ea%b9%8c%ec%a7%80%20%ea%b0%80%eb%8a%94%20%ea%b8%b8&source=http%3a%2f%2fcjlee38.github.io%2fbackup%2flanguage%2fpython%2f2021-09-16-journey-to-property%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share # (Python) @Property까지 가는 길 on reddit" href="https://reddit.com/submit?url=http%3a%2f%2fcjlee38.github.io%2fbackup%2flanguage%2fpython%2f2021-09-16-journey-to-property%2f&title=%23%20%28Python%29%20%40Property%ea%b9%8c%ec%a7%80%20%ea%b0%80%eb%8a%94%20%ea%b8%b8"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share # (Python) @Property까지 가는 길 on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2fcjlee38.github.io%2fbackup%2flanguage%2fpython%2f2021-09-16-journey-to-property%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share # (Python) @Property까지 가는 길 on whatsapp" href="https://api.whatsapp.com/send?text=%23%20%28Python%29%20%40Property%ea%b9%8c%ec%a7%80%20%ea%b0%80%eb%8a%94%20%ea%b8%b8%20-%20http%3a%2f%2fcjlee38.github.io%2fbackup%2flanguage%2fpython%2f2021-09-16-journey-to-property%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share # (Python) @Property까지 가는 길 on telegram" href="https://telegram.me/share/url?text=%23%20%28Python%29%20%40Property%ea%b9%8c%ec%a7%80%20%ea%b0%80%eb%8a%94%20%ea%b8%b8&url=http%3a%2f%2fcjlee38.github.io%2fbackup%2flanguage%2fpython%2f2021-09-16-journey-to-property%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=http://cjlee38.github.io/>cjlee38</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>